<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery.fancytable/dist/fancyTable.min.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.css">
  <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='./style.css')}}">
</head>

<body>
  <div class="text-center">
    <h2>Upload Image to Classify</h2>
  </div>
  <!-- <input type="button" value="Predict"> -->
  <!-- <input type="button" value="Rerun"> -->

  <div class="container">
    <div class="row">
      <div class="col-md-6">

        <div class="image_uploaded" id="image_uploaded">
          <label for="file"></label>
          <!-- <img id="uploaded_image" width="400"/> -->
          <img id="picture" src="data:image/jpeg;base64,{{ data.img_data }}" style="display:{{data.table_display}};">
          <!-- <img id="output" width="200" /> -->
        </div>
      </div>
      <div class="col-md-6">
        <form class="w3-container w3-card-2" action="{{ url_for('getconcepts')}}" method="POST" style="width: 100%" ,
          enctype="multipart/form-data">
          <label for="file"></label>
          <input type="file" id="img" name="img" accept="image/*" onchange="loadFile(event)" style="margin-top: 2vw">
          <button type="submit" class="predict-btn btn btn-success" id="predict-btn" style="display: none; margin-top: 1vw;">Upload Image and Predict</button>
        </form>
        <button id="rerun_btn" class="btn btn-info" type="submit" onclick="document.getElementById('concept-form').submit();" style="margin-top: 1vw; display:{{data.table_display}};">Rerun</button>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <div class="prediction" id="prediction" style="display:{{data.table_display}};">
          <h3 style="margin-top: 1vw;"><b>Predicted Concepts: </b></h3><br>
          <div class="concept-predict" id="concept-predict">
            <form class="concept-form" id="concept-form" action="{{ url_for('rerun')}}" method="POST"
              style="width: 100%">
              <table class="concept-prob table-responsive table-bordered table" id="concept-prob"
                class="centered thick-border">
                <tr>
                  <th>Concept_no</th>
                  <th>Concept</th>
                  <th>Probability</th>
                </tr>
                <tbody class="edit_tab">
                  {% for k, v in data.concepts.items() %}
                  <tr>
                    <td>{{k}}</td>
                    <td>{{ v.attribute }}</td>
                    <td> <input id="{{v.attribute}}" type="text" name="{{ k }}" value=" {{v.value}} "
                        style="padding: 0; border : None" onchange="changeValue(event)"></td>
                    <!-- <td class="con-val">{{ v }}</td> -->
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </form>
          </div>

        </div>
      </div>

      <div class="col-md-6 align-items-center" >
        <div class="species-predict mx-auto" id="species-predict"  style="display:{{data.table_display}}; ">
        <h3 style="margin-top: 1vw;"><b>Class Probabilities: </b></h3><br>
        <table class="classify-prob table-responsive table-bordered table mx-auto" id="classify-prob"
            class="centered thick-border" style="width: fit-content;">
            <tr>
              <th>Species</th>
              <th>Probability</th>
            </tr>
            {% for k, v in data.class_probabilities.items() %}
            <tr>
              <td>{{ k }}</td>
              <td>{{ v }}</td>
            </tr>
            {% endfor %}
          </table>
        </div>
      </div>

    </div>
  </div>
</body>

<script type="text/javascript">
  var loadFile = function (event) {
    document.getElementById("image_uploaded").style.display = "block";
    document.getElementById("predict-btn").style.display = "block";
    var image = document.getElementById('uploaded_image');
    image.src = URL.createObjectURL(event.target.files[0]);

  };



  var changeValue = function (event) {
    var changed_attribute = event.target.id;
    var changed_Value = event.target.value;
  }

  $(document).ready(function () {
    $(".concept-prob").fancyTable({
      pagination: true,
      perPage: 10,
      globalSearch: false,
    });
  });


  $(document).ready(function () {
    $(".classify-prob").fancyTable({
      pagination: true,
      perPage: 10,
      globalSearch: false,
    });

  });
</script>


</html>